{% if shape.documentation %}
-- | {{ shape.documentation }}
{% endif %}
{{ shape.declaration }}

{% for ctor in shape.constructors %}
pattern {{ ctor.key }} :: {{ shape.name }}
pattern {{ ctor.key }} = {{ shape.constructor }} "{{ ctor.value }}"

{% endfor %}
{-# COMPLETE
{% for ctor in shape.constructors %}
  {{ ctor.key }},
{% endfor %}
  {{ shape.constructor }} #-}

instance FromText {{ shape.name }} where
    parser = ({{ shape.constructor}} . mk) <$> takeText

instance ToText {{ shape.name }} where
    toText ({{ shape.constructor }} ci) = original ci

-- | Represents an enum of /known/ ${{shape.name}}.
--   AWS may have added more since the source was generated.
--   This instance exists only for backward compatibility.
--   fromEnum is a partial function, and will error on values unknown at generation time.
instance Enum {{ shape.name }} where
    toEnum i = case i of
        {% for ctor in shape.constructors %}
        {{ ctor.index0 }} -> {{ ctor.key }}
        {% endfor %}
        _ -> (error . showText) $ "Unknown index for {{ shape.name }}: " <> toText i
    fromEnum x = case x of
        {% for ctor in shape.constructors %}
        {{ ctor.key }} -> {{ ctor.index0 }}
        {% endfor %}    
        {{ shape.constructor }} name -> (error . showText) $ "Unknown {{ shape.name }}: " <> original name

-- | Represents the bounds of /known/ ${{shape.name}}.
--   AWS may have added more since the source was generated.
--   This instance exists only for backward compatibility.
instance Bounded {{ shape.name }} where
    {% for ctor in shape.constructors %}
    {% if ctor.first %}
    minBound = {{ ctor.key }}
    {% endif %}
    {% if ctor.last %}
    maxBound = {{ ctor.key }}
    {% endif %}
    {% endfor %}

instance Hashable     {{ shape.name }}
instance NFData       {{ shape.name }}
instance ToByteString {{ shape.name }}
instance ToQuery      {{ shape.name }}
instance ToHeader     {{ shape.name }}
{% for inst in shape.instances %}
  {% case inst.value %}
  {% when "ToQuery" %}
  {% when "FromJSON" %}

instance FromJSON {{ shape.name }} where
    parseJSON = parseJSONText "{{ shape.name }}"
  {% when "ToJSON" %}

instance ToJSON {{ shape.name }} where
    toJSON = toJSONText
  {% when "FromXML" %}

instance FromXML {{ shape.name }} where
    parseXML = parseXMLText "{{ shape.name }}"
  {% when "ToXML" %}

instance ToXML {{ shape.name }} where
    toXML = toXMLText
  {% else %}

Error: Attempting to render unrecognized instance '{{ inst.value }}'
  {% endcase %}
{% endfor %}
